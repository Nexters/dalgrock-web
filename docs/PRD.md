# Dalgrock PRD (Product Requirements Document)

**작성일:** 2025년 1월 18일

**목표 출시일:** 2025년 1월 31일

---

## 1. 제품 개요

### 1.1 비전

"음악 기록을 통해 나를 돌아보게 하는 서비스"

### 1.2 핵심 가치

- 일상 속 음악과 감정/상황을 연결하여 기록
- 누적된 기록을 통한 자기 성찰 기회 제공
- 음악과 내 상태의 연관성 분석

### 1.3 MVP 목표

사용자가 매일 듣는 음악에 감정과 상황을 태깅하여 기록하고, 주간 단위로 자신의 감정 패턴과 음악 취향을 돌아볼 수 있는 핵심 플로우 구현

### 1.4 MVP 범위

- 카카오 로그인
- 오늘 날짜 기록 생성
- 기록 수정/삭제 (분석 전 기록에 한해)
- 기록 목록 조회
- 주간 분석 리포트 (매주 일요일 18:00~19:00 배치 생성)

---

## 2. 유저 스토리

| 유저 스토리 | 우선순위 |
| --- | --- |
| 사용자로서, 카카오 계정으로 간편하게 로그인하고 싶다 | P0 |
| 사용자로서, 오늘 들은 음악과 함께 내 감정/상황을 기록하고 싶다 | P0 |
| 사용자로서, 아직 분석되지 않은 기록은 수정하거나 삭제하고 싶다 | P0 |
| 사용자로서, 내가 남긴 기록들을 카드 형태로 모아보고 싶다 | P0 |
| 사용자로서, 이번 주 내 음악 기록을 분석받아 나를 돌아보고 싶다 | P0 |

---

## 3. 기능 상세 명세

### 3.1 카카오 로그인

**기능 설명**

카카오 OAuth를 통한 소셜 로그인 구현

**기능 요구사항**

| ID | 요구사항 | 상세 |
| --- | --- | --- |
| F1-01 | 카카오 로그인 버튼 | 카카오 디자인 가이드라인 준수 |
| F1-02 | 신규 가입 처리 | 최초 로그인 시 자동 회원가입 |
| F1-03 | 수집 정보 | 카카오 계정 ID, 닉네임, 프로필 이미지 |
| F1-04 | 로그인 상태 유지 | JWT 토큰 기반 세션 관리 |
| F1-05 | 로그아웃 | 로그아웃 버튼 존재 |

**유저 플로우**

```
[스플래시 + 카카오 로그인 버튼] → [카카오 인증] → [홈 화면]
```

---

### 3.2 기록 추가

**기능 설명**

사용자가 오늘 들은 음악과 함께 감정, 상황, 장소, 메모를 기록

> 기록을 자세히 추가할수록 더 상세한 분석 리포트를 받을 수 있어요

**제약사항**

- 기록 날짜는 항상 "오늘"로 고정 (추후 스트릭/잔디 기능을 위해 작성 날짜 추적 필요)
- 기록 생성 후 수정/삭제는 **분석되기 전까지만** 가능 (일요일 18:00~19:00 배치 이후 불가)

**입력 필드 상세**

| 필드명 | 필수여부 | 입력 방식 | 상세 |
| --- | --- | --- | --- |
| 음악 선택 | **필수** | 검색 → 다중선택 | 최소 1곡, 복수 선택 가능 (배열) |
| 감정 태그 | **필수** | 다중선택 | 사전 정의된 20개 태그 중 1개 이상 선택 (직접입력 불가) |
| 내용 | 선택 | 텍스트 입력 | 오늘 있었던 일 자유 기술, 최대 1000자 |
| 상황/맥락 | 선택 | 다중선택 | 사전 정의된 15개 태그 중 0개 이상 선택 (직접입력 불가) |
| 장소 | 선택 | 텍스트 입력 | 직접 입력, 최대 50자 |

**감정 태그 목록 (20개)**

| 태그 | 설명 | 서버 값 |
| --- | --- | --- |
| 행복 | 기쁘고 즐거운 감정 | `happiness` |
| 설렘 | 두근거리고 기대되는 감정 | `excitement` |
| 평온 | 차분하고 편안한 감정 | `calm` |
| 감동 | 마음이 벅차오르는 감정 | `touched` |
| 뿌듯함 | 성취감, 자부심을 느끼는 감정 | `pride` |
| 신남 | 들뜨고 에너지가 넘치는 감정 | `energetic` |
| 감사 | 고마움을 느끼는 감정 | `gratitude` |
| 사랑 | 애정과 따뜻함을 느끼는 감정 | `love` |
| 우울 | 가라앉고 처진 감정 | `depressed` |
| 불안 | 걱정되고 초조한 감정 | `anxious` |
| 분노 | 화나고 짜증나는 감정 | `angry` |
| 그리움 | 누군가/무언가가 생각나는 감정 | `nostalgic` |
| 외로움 | 혼자라고 느끼는 감정 | `lonely` |
| 권태 | 지루하고 무기력한 감정 | `bored` |
| 허무 | 공허하고 의미없게 느껴지는 감정 | `empty` |
| 피곤 | 지치고 녹초가 된 감정 | `tired` |
| 긴장 | 초조하고 조마조마한 감정 | `nervous` |
| 후회 | 아쉽고 되돌리고 싶은 감정 | `regretful` |
| 질투 | 부럽고 샘나는 감정 | `jealous` |
| 복잡미묘 | 여러 감정이 섞인 상태 | `complicated` |

**상황/맥락 태그 목록 (15개)**

| 태그 | 서버 값 |
| --- | --- |
| 출근길 | `commute_to_work` |
| 퇴근길 | `commute_from_work` |
| 드라이브 | `driving` |
| 산책 | `walking` |
| 운동 | `exercising` |
| 공부 | `studying` |
| 작업/업무 | `working` |
| 집안일 | `housework` |
| 독서 | `reading` |
| 잠자기 전 | `before_sleep` |
| 아침 기상 | `morning` |
| 샤워 | `shower` |
| 낮잠 | `napping` |
| 데이트 | `date` |
| 카페 | `cafe` |

**음악 검색 기능**

백엔드에서 Spotify Web API (Client Credentials Flow)를 사용하여 음악 검색 기능 제공. 사용자의 Spotify 계정 연동은 필요하지 않음.

| ID | 요구사항 |
| --- | --- |
| F2-01 | 검색 입력창에 타이핑 시 debounce 적용하여 API 호출 |
| F2-02 | 검색 결과는 입력창 아래 드롭다운으로 표시 |
| F2-03 | 드롭다운에 앨범 커버, 곡명, 아티스트명 표시 |
| F2-04 | 드롭다운에서 곡 선택 시 기록에 추가 |
| F2-05 | 선택된 곡은 입력창 아래 리스트로 표시, 개별 제거 가능 |
| F2-06 | 저장 시: spotify_track_id, 곡명, 아티스트명, 앨범 커버 URL 저장 |

**유저 플로우**

```
[홈 화면]
    ↓ [오늘의 기록 추가 버튼]
[기록 작성 화면]
    - 음악 검색 입력창 타이핑
    - 드롭다운에서 곡 선택 (다중 가능)
    - 선택된 음악 목록 표시
    - 감정 태그 선택 (필수)
    - 상황/맥락 선택 (선택)
    - 장소 입력 (선택)
    - 내용 입력 (선택)
    ↓ [저장 버튼]
[홈 화면] - 새 기록 추가됨
```

---

### 3.3 내 기록 보기

**기능 설명**

사용자가 작성한 기록을 카드 형태로 조회

**기능 요구사항**

| ID | 요구사항 | 상세 |
| --- | --- | --- |
| F3-01 | 카드 리스트 | 각 기록을 카드 형태로 표시 |
| F3-02 | 정렬 | 최신순 고정 (최근 기록이 상단) |
| F3-03 | 빈 상태 | 기록이 없을 때 안내 메시지 + 기록 추가 유도 |
| F3-04 | 기록 상세 | 카드 클릭 시 상세 화면 이동 |

**카드 UI 구성요소**

```
┌─────────────────────────────────────┐
│  📅 2025년 1월 18일 토요일          │
├─────────────────────────────────────┤
│  ┌───────┐                          │
│  │ 앨범  │  곡명                    │
│  │ 커버  │  아티스트명              │
│  └───────┘                          │
│  (복수 곡일 경우: +N곡 더보기)       │
├─────────────────────────────────────┤
│  행복    출근길                      │
├─────────────────────────────────────┤
│  "오늘 승진 소식을 들었다..."       │
│  (내용 2줄 미리보기, 더보기→상세)    │
└─────────────────────────────────────┘
```

**기록 상세 화면**

- 해당 기록의 모든 정보 전체 표시
- 선택된 모든 음악 리스트
- 감정 태그, 상황 태그, 장소
- 내용 전문
- **분석되기 전 기록에만** 수정/삭제 버튼 표시

---

### 3.4 주간 분석

**기능 설명**

주 단위로 사용자의 음악 기록을 분석하여 인사이트 제공

**분석 기준**

- 분석 주기: 매주 일요일 18:00~19:00 배치 실행
- 분석 대상: 이전 배치 이후 ~ 현재 배치까지의 기록
- 최소 기록 수: **1개 이상**

**분석 항목**

| 분석 영역 | 분석 내용 | 데이터 소스 | LLM 사용 |
| --- | --- | --- | --- |
| 주간 요약 | 이번 주를 한 문장으로 요약 | 전체 기록 종합 | ✅ |
| 내 이번주 음악 분석 | 이번 주 들은 음악 통계, Top 아티스트 | 음악 데이터 | ❌ |
| 내 이번주 감정 분석 | 감정 태그 비율, 감정 흐름, 음악과 감정의 관계 | 감정 태그 + 선택한 곡들의 가사/분위기 | ✅ |
| 내 이번주 돌아보기 | 상황별 음악 청취 패턴, 한 주 피드백 (격려/응원/위로) | 상황 태그 통계 + 내용 필드 | ✅ |

**기술 요구사항**

| ID | 요구사항 |
| --- | --- |
| F4-01 | 배치 실행: 매주 일요일 18:00~19:00 사이 |
| F4-02 | 배치 실행 시점 기준으로 한 주 구분 |
| F4-03 | 배치 완료 후 해당 주 기록들은 수정/삭제 불가 |
| F4-04 | 기록 1개 이상 시 분석 생성 |
| F4-05 | LLM API 연동: 주간 요약, 감정 분석, 돌아보기 메시지 생성 |

---

## 4. 홈 화면 (대시보드)

**기능 설명**

로그인 후 진입하는 메인 화면. 사용자의 기록 현황 요약과 주요 액션 제공.

**화면 구성**

```
┌─────────────────────────────────────┐
│  👋 OOO님, 안녕하세요!              │
│                                     │
├─────────────────────────────────────┤
│  📊 이번 주 기록                    │
│  ┌─────────┐  ┌─────────┐          │
│  │   3개   │  │  12개   │          │
│  │ 이번 주 │  │ 전체    │          │
│  └─────────┘  └─────────┘          │
│                                     │
│  🔥 N일 연속 기록 중!               │
│  (또는: 오늘 기록을 남겨보세요!)     │
│                                     │
├─────────────────────────────────────┤
│  ┌─────────────────────────────┐   │
│  │  📈  내 리포트 보기          │   │
│  │  이번 주 분석 확인하기       │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  📋  내 기록 보기            │   │
│  │  지난 기록들 둘러보기        │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  ✏️  오늘의 기록 추가        │   │
│  │  오늘의 음악과 감정 남기기    │   │
│  └─────────────────────────────┘   │
└─────────────────────────────────────┘
```

**표시 정보**

| 항목 | 설명 |
| --- | --- |
| 사용자 인사 | 닉네임 + 인사말 |
| 이번 주 기록 수 | 현재 배치 주기 내 기록 개수 |
| 전체 기록 수 | 누적 전체 기록 개수 |
| 연속 기록 | 연속으로 기록한 일수 (오늘 기록 없으면 "오늘 기록을 남겨보세요!" 표시) |

**액션 버튼 3개**

| 버튼 | 이동 화면 | 설명 |
| --- | --- | --- |
| 내 리포트 보기 | 주간 분석 | 이번 주 분석 리포트 |
| 내 기록 보기 | 기록 목록 | 전체 기록 카드 리스트 |
| 오늘의 기록 추가 | 기록 작성 | 새 기록 작성 |

---

## 5. 화면 목록

| ID | 화면명 | 설명 | 주요 액션 |
| --- | --- | --- | --- |
| S-01 | 스플래시/로그인 | 앱 로고 + 카카오 로그인 버튼 | 로그인 |
| S-02 | 홈 (대시보드) | 기록 요약 + 주요 액션 버튼 | 리포트 보기, 기록 보기, 기록 추가 |
| S-03 | 기록 목록 | 내 기록 카드 리스트 | 상세 이동 |
| S-04 | 기록 작성 | 새 기록 입력 폼 (음악 검색 드롭다운 포함) | 음악 검색/선택, 태그 선택, 저장 |
| S-05 | 기록 상세 | 개별 기록 전체 보기 | 수정, 삭제 (분석 전 한정), 뒤로가기 |
| S-06 | 리포트 목록 | 주간 리포트 카드 리스트 | 상세 이동 |
| S-07 | 리포트 상세 | 주간 리포트 전체 보기 | 뒤로가기 |
